(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[602],{129:(e,t,s)=>{Promise.resolve().then(s.bind(s,1420))},1420:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var r=s(5155),a=s(2115),i=s(5695),o=s(5333),n=s(6631);function l(){var e,t;let[s,l]=(0,a.useState)([]),[c,u]=(0,a.useState)(0),[d,h]=(0,a.useState)(0),[g,m]=(0,a.useState)(!1),[x,f]=(0,a.useState)(!0),[w,b]=(0,a.useState)(""),N=(0,i.useRouter)(),p=(0,n.A)();(0,a.useEffect)(()=>{(async()=>{try{let{data:{user:e},error:t}=await o.N.auth.getUser();if(t||!e)return void N.push("/login");y()}catch(e){console.error("Auth check error:",e),N.push("/login")}})()},[N]);let y=async()=>{try{let{data:e,error:t}=await o.N.from("questions").select("*").order("id");if(t)throw t;l(e),f(!1)}catch(e){console.error("Error fetching questions:",e),b("Failed to load questions"),f(!1)}},v=async e=>{e===s[c].correct_answer&&h(d+1);try{let{data:{user:t}}=await o.N.auth.getUser(),{error:r}=await o.N.from("user_answers").insert([{user_id:t.id,question_id:s[c].id,selected_answer:e,is_correct:e===s[c].correct_answer}]);if(r)throw r}catch(e){console.error("Error saving answer:",e)}if(c+1<s.length)u(c+1);else{try{let{data:{user:t}}=await o.N.auth.getUser(),{error:r}=await o.N.from("scores").insert([{user_id:t.id,score:d+ +(e===s[c].correct_answer),total_questions:s.length}]);if(r)throw r}catch(e){console.error("Error saving score:",e)}m(!0)}},j=async()=>{try{let{data:{user:e}}=await o.N.auth.getUser(),{error:t}=await o.N.from("scores").insert([{user_id:e.id,score:d,total_questions:s.length}]);if(t)throw t;N.push("/results")}catch(e){console.error("Error submitting score:",e)}};return x||p?(0,r.jsx)("div",{children:"Loading..."}):w?(0,r.jsx)("div",{children:w}):g?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-blue-500 to-purple-600 flex flex-col items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-xl max-w-md w-full",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Quiz Completed!"}),(0,r.jsxs)("p",{className:"text-lg text-gray-600 mb-6",children:["You scored ",d," out of ",s.length]}),(0,r.jsx)("button",{onClick:j,className:"block w-full bg-blue-600 text-white text-center py-3 rounded-lg hover:bg-blue-700 transition duration-200",children:"View Results"})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-blue-500 to-purple-600 flex flex-col items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-xl max-w-md w-full",children:[(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsxs)("span",{className:"text-sm text-gray-600",children:["Question ",c+1,"/",s.length]})}),(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:null==(e=s[c])?void 0:e.question}),(0,r.jsx)("div",{className:"space-y-4",children:null==(t=s[c])?void 0:t.options.map((e,t)=>(0,r.jsx)("button",{onClick:()=>v(e),className:"block w-full bg-gray-100 text-gray-800 text-center py-3 rounded-lg hover:bg-gray-200 transition duration-200",children:e},t))})]})})}},5333:(e,t,s)=>{"use strict";s.d(t,{N:()=>o});var r=s(851);let a="https://xybazndugmjeeqxvlwgd.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh5YmF6bmR1Z21qZWVxeHZsd2dkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDU2ODgyMjIsImV4cCI6MjA2MTI2NDIyMn0.MZwuXD103K1XGjr0_NdYiqdmk_YDF7VNN78aNSoQzNU";if(!a||!i)throw Error("Missing Supabase environment variables");let o=(0,r.UU)(a,i)},6631:(e,t,s)=>{"use strict";s.d(t,{A:()=>o});var r=s(2115),a=s(5695),i=s(5333);function o(){let[e,t]=(0,r.useState)(!0),s=(0,a.useRouter)();return(0,r.useEffect)(()=>{(async()=>{try{let{data:{session:e},error:r}=await i.N.auth.getSession();if(r)throw r;if(!e)return void s.push("/login");t(!1)}catch(e){console.error("Auth check error:",e),s.push("/login")}})()},[s]),e}}},e=>{var t=t=>e(e.s=t);e.O(0,[125,441,684,358],()=>t(129)),_N_E=e.O()}]);